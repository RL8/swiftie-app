import{b,t as H,a as f,s as S,e as W}from"../chunks/CwZ8Xtob.js";import{p as X,g as Y,z as M,a as Z,f as ee,t as z,b as e,e as $,A as N,s as E,x as k,n as O,c as p,r as i,i as te}from"../chunks/DdAb7SBl.js";import{a as A,i as se}from"../chunks/BObVumWD.js";import{S as ae,e as j,t as R,i as T}from"../chunks/Bq2RDtik.js";import{F as re,B as q,a as ne}from"../chunks/BoqfqeOI.js";import{s as I}from"../chunks/Klx04lHM.js";import{t as oe,f as le}from"../chunks/C7z8GXxJ.js";import{g as D,b as G}from"../chunks/CgP7GmAE.js";import{H as ie}from"../chunks/C4Gd1zx6.js";function ve(s){const L="150ms",d="cubic-bezier(0.4, 0, 0.2, 1)";function t(){s.style.transition=`transform ${L} ${d}`}function a(){t(),s.style.transform="scale(0.97)"}function v(){t(),s.style.transform="scale(1)"}return t(),s.addEventListener("touchstart",a),s.addEventListener("touchend",v),s.addEventListener("mousedown",a),s.addEventListener("mouseup",v),s.addEventListener("mouseleave",v),{destroy(){s.removeEventListener("touchstart",a),s.removeEventListener("touchend",v),s.removeEventListener("mousedown",a),s.removeEventListener("mouseup",v),s.removeEventListener("mouseleave",v)}}}var ce=b('<div class="selected-album svelte-63z5h3"><div class="vinyl-mini svelte-63z5h3"><img class="vinyl-art-mini svelte-63z5h3"> <div class="vinyl-grooves-mini svelte-63z5h3"></div> <div class="vinyl-center-mini svelte-63z5h3"></div> <div class="heart-badge-mini svelte-63z5h3"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="heart-icon"><path d="M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z"></path></svg> <span class="heart-number-mini svelte-63z5h3"></span></div></div></div>'),de=b('<div class="albums-stack svelte-63z5h3" slot="left"></div>'),ue=b('<div class="heart-badge-song svelte-63z5h3"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="heart-icon"><path d="M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z"></path></svg> <span class="heart-number-song svelte-63z5h3"> </span></div>'),me=b('<button class="song-card svelte-63z5h3"><div class="song-info svelte-63z5h3"><span class="song-number svelte-63z5h3" style="text-align: right;"></span> <span class="song-title svelte-63z5h3"> </span></div> <!></button>'),pe=b('<main slot="main" class="flex flex-col items-center justify-start h-full p-4"><div class="songs-container svelte-63z5h3"></div></main>'),fe=b("<!> <!>",1);function we(s,L){X(L,!0);const d=Y("music")();let t=M(A([])),a=M(0);const v=k(()=>d.selectedAlbums[e(a)]);function J(u){e(t).indexOf(u)!==-1?E(t,A(e(t).filter(m=>m!==u))):e(t).length<3&&E(t,A([...e(t),u]))}function K(){e(a)>0?(N(a,-1),E(t,A(d.selectedSongsByAlbum.get(d.selectedAlbums[e(a)].id)||[]))):D(`${G}/albums/confirm`)}function Q(){e(t).length===3&&(d.updateSelectedSongs(e(v).id,e(t)),e(a)<2?(N(a),E(t,A(d.selectedSongsByAlbum.get(d.selectedAlbums[e(a)].id)||[]))):D(`${G}/albums/results`))}ae(s,{$$slots:{header:(u,C)=>{const m=k(()=>e(v)?.title);ie(u,{slot:"header",variant:"progress",get title(){return`Now, select your 3 top bangers from ${e(m)??""}`},subtitle:"Choose your favorite songs",get progress(){return e(t).length},maxProgress:3,$$slots:{left:(g,x)=>{var r=de();j(r,21,()=>d.selectedAlbums,T,(_,o,n)=>{var c=ce();I(c,"style",`transform: translate(${n*-4}px, ${n*-4}px)`);var l=p(c),y=p(l),w=$(y,6),P=$(p(w),2);P.textContent=n+1,i(w),i(l),i(c),z(()=>{R(c,"active",n===e(a)),I(y,"src",e(o).coverArt),I(y,"alt",e(o).title)}),f(_,c)}),i(r),f(g,r)}}})},main:(u,C)=>{var m=pe(),g=p(m);j(g,21,()=>e(v)?.songs||[],T,(x,r,_)=>{var o=me(),n=p(o),c=p(n);c.textContent=`${_+1}.`;var l=$(c,2),y=p(l,!0);i(l),i(n);var w=$(n,2);{var P=h=>{var B=ue(),F=$(p(B),2),U=p(F,!0);i(F),i(B),z(V=>S(U,V),[()=>e(t).indexOf(e(r))+1]),f(h,B)};se(w,h=>{e(t).includes(e(r))&&h(P)})}i(o),te(()=>W("click",o,()=>J(e(r)))),ne(o,h=>ve?.(h)),z(h=>{R(o,"selected",h),S(y,e(r))},[()=>e(t).includes(e(r))]),f(x,o)}),i(g),i(m),oe(1,g,()=>le),f(u,m)},footer:(u,C)=>{re(u,{variant:"nav",slot:"footer",children:(m,g)=>{var x=fe(),r=ee(x);q(r,{variant:"secondary",$$events:{click:K},children:(n,c)=>{O();var l=H();z(()=>S(l,e(a)>0?"Previous Album":"Back")),f(n,l)},$$slots:{default:!0}});var _=$(r,2);const o=k(()=>e(t).length<3);q(_,{variant:"primary",get disabled(){return e(o)},$$events:{click:Q},children:(n,c)=>{O();var l=H();z(()=>S(l,e(a)<2?"Next Album":"See Results")),f(n,l)},$$slots:{default:!0}}),f(m,x)},$$slots:{default:!0}})}}}),Z()}export{we as component};
